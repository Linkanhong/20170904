<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> 
  <meta name="keywords" content="店装帮">
  <meta name="description" content="店装帮，让店装更便捷" />
  <title>重罝密码</title>
  <link rel="shortcut icon" href="favicon.ico"/>
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="css/Payeng.css">
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" type="text/css" href="css/user.css">
  <style>
  	.p-ul>li:nth-of-type(2) span:after{color:#0085d0;}

  </style>

</head>
<body >
  <header class="t-header">     
    <div class="container-fluid p-nopadding t-top p-container">
        <span><a href="index.html"><img src="img/logo.png" alt="店装帮"></a><em>让店装更便捷</em></span>
        <ul class="list-inline pull-right p-nopadding t-ul">
            <li id="index_head"><a href="login.html">登录</a><a href="register.html">免费注册</a></li>
            <li class="p-paddingLeft8" id="showsysout"></li>
        </ul>            
    </div>   
  </header><!--end headr -->

  <nav class="navbar navbar-default t-nomargin t-navbar">
    <div class="container-fluid p-container p-nopadding ">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse p-nopadding" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav t-width100">
          <li class="dropdown t-background t-li">
            <a href="#" class="dropdown-toggle t-fontcolor6 c-dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><img src="img/nav-icon.png" alt="" class="t-por3 c-navicon">全部导航<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="index.html">首页<span class="icon-navshouye pull-right p-iconBefore"></span></a></li>
              <li role="separator" class="divider"></li>
              <li><a href="seller-list.html">找需求<span class="icon-navchuangkezhongxin pull-right p-iconBefore"></span></a></li>
              <li role="separator" class="divider"></li>
              <li><a href="stuff.html">找材料<span class="icon-navzhaocailiao pull-right p-iconBefore"></span></a></li>
              <li role="separator" class="divider"></li>
              <li><a href="maker.html">创客中心<span class="icon-navchuangkezhongxin pull-right p-iconBefore"></span></a></li>
            </ul>
          </li>
          <li><a href="user-information.html">账户设置</a></li>
          <li><a href="uese-myMember.html">会员中心</a></li>
          <li><a href="user-notice.html">消息中心</a></li>
          <li></li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
  </nav><!--end nav -->  


<div class="container-fluid text-center p-container p-nopadding u-margin">
	<div class="jumbotron">
	  <ol class="breadcrumb text-left">
		  <li><a href="index.html">首页</a></li>
		  <li class="active">重置密码</li>
	  </ol>
	  <ul class="list-inline p-ul col-md-8 col-md-offset-2">
	  	<li class="col-md-3"><span class="p-background p-after">1</span> <br>填写账号</li>
	  	<li class="col-md-3"><span class="p-background p-after">2</span> <br>验证身份</li>
	  	<li class="col-md-3 p-nocolor"> <span class="p-background">3</span> <br>重罝密码</li>
	  	<li class="col-md-3"> <span>4</span> <br>找回成功</li>
	  </ul>
	  <div class="clearfix"></div>
	  <form>
	  	<div class="form-group col-md-6 col-md-offset-3 p-input">
	  		<input type="hidden"  class="form-control" id="USER_ID" value="" placeholder="" >
	  		<input type="hidden"  class="form-control" id="PHONE" value="" placeholder="" >
		    <input type="password"  class="form-control" id="password" placeholder="新登录密码" maxlength="20">
		    <sub class="p-sub">必须是6-20位英文、数字或符号</sub>
		</div>
	  	<div class="form-group col-md-6 col-md-offset-3 p-marb p-input text-left">
		    <input type="password"  class="form-control" id="password1" placeholder="确认新密码" maxlength="20">
		    <sub class="p-fontcolor18 c-sub">两次输入的密码不一致</sub>
		</div>
	  </form>
	  <div class="clearfix"></div>
	  <p class="text-center"><a class="btn btn-primary p-btn1 p-submit c-submmit" role="button" >确定</a></p>
	</div>
</div><!-- /content -->

<div class="container-fluid footer" id="footer1">
</div><!-- /footer -->



<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="js/jquery-3.2.0.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/Payeng.js"></script>

<script>

	$(document).on(
			"blur",
			"#password",
			function() {
			if ($("#password").val() !== $("#password1").val() ) {
				$(".c-sub").css({visibility: 'visible'});
				$('.c-submmit').removeAttr('onclick');
				$('.c-submmit').css({background: '#bebebe',borderColor:'#bebebe'});				
			}else if($("#password").val() == $("#password1").val()){
				$(".c-sub").css({visibility: 'hidden'});
				$('.c-submmit').attr('onclick', 'alterPassword();');
				$('.c-submmit').css({background: '#0085d0',borderColor:'#0085d0'});			

			};
	});

	$(document).on(
			"click",
			".c-submmit",
			function() {
				if ( $("#password").val() =='' && $("#password1").val() == '' ) {
					window.wxc.xcConfirm("密码不能为空",window.wxc.xcConfirm.typeEnum.error);
				}else if ($("#password").val() =='' || $("#password").val().length<6 ) {
					window.wxc.xcConfirm("请输入6-20位新密码",window.wxc.xcConfirm.typeEnum.error);
				}else if ($("#password1").val() =='' ) {
					window.wxc.xcConfirm("请输入确认密码",window.wxc.xcConfirm.typeEnum.error);
				}else if ($("#password").val() == $("#password1").val()) {
					$(this).css({background: '#0085d0',borderColor:'#0085d0'});
					$(this).attr('onclick', 'alterPassword();');			
				};

			});
	

	// $(function(){
	// 	$("#password1").blur(function(event) {
	// 		if ($("#password").val() !== $("#password1").val() ) {
	// 			$(".c-sub").css({visibility: 'visible'});
	// 			$('.c-submmit').removeAttr('onclick');
	// 			$('.c-submmit').css({background: '#bebebe',borderColor:'#bebebe'});				
	// 		}else if($("#password").val() == $("#password1").val()){
	// 			$(".c-sub").css({visibility: 'hidden'});
	// 			$('.c-submmit').attr('onclick', 'alterPassword();');
	// 			$('.c-submmit').css({background: '#0085d0',borderColor:'#0085d0'});			

	// 		};
	// 	});
	// 	$('.c-submmit').click(function(event) {
	// 		if ( $("#password").val() =='' || $("#password").val().length<6 ) {
	// 			window.wxc.xcConfirm("请输入6-20位新密码",window.wxc.xcConfirm.typeEnum.error);
	// 		}else if ($("#password1").val() =='' ) {
	// 			window.wxc.xcConfirm("请输入确认密码",window.wxc.xcConfirm.typeEnum.error);
	// 		}else if ($("#password").val() == $("#password1").val()) {
	// 			$(this).css({background: '#0085d0',borderColor:'#0085d0'});
	// 			$(this).attr('onclick', 'alterPassword();');			
	// 		};
	// 	});
	// });
</script>
<script>
	$(function() {
		$("#USER_ID").val(GetQueryString("userid"));
		$("#PHONE").val(GetQueryString("phone"));
	});
	function GetQueryString(name)
	{
	     var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
	     var r = window.location.search.substr(1).match(reg);
	     if(r!=null)return  unescape(r[2]); return null;
	}
	
	function alterPassword(){
		var phone = $("#PHONE").val();
		var userid = $("#USER_ID").val();
		var password = $("#password").val();
		
		$.ajax({
			url: '/DZBang_entrance/happuser/alterpasswordbyphone.do',
			type: 'post',
	    	data: {USER_ID:userid,PHONE:phone,PASSWORD:password,tm:new Date().getTime()},
	    	dataType: 'json',
			cache: false,
			'success': function(data){
				if(data.result == "success"){
					window.location.href= "password-success.html" + "?flag="+Math.random();;
				}else{
					window.wxc.xcConfirm("你好，密码修改失败,请重新修改密码",window.wxc.xcConfirm.typeEnum.error);
				}
			},
			'error':function(data){
				window.wxc.xcConfirm("你好，密码修改失败,请重新修改密码",window.wxc.xcConfirm.typeEnum.error);
			}
		});
	};


</script>

</body>
</html>